CREATE DATABASE Salesman;
USE Salesman;

CREATE TABLE SALESMAN(
SALESMAN_ID INT PRIMARY KEY, 
NAME VARCHAR(30),
CITY VARCHAR(30),
COMMISSION VARCHAR(30)
);

CREATE TABLE CUSTOMER(
CUSTOMER_ID INT PRIMARY KEY,
CUST_NAME VARCHAR(30),
CITY VARCHAR(30),
GRADE INT,
SALESMAN_ID INT,
FOREIGN KEY(SALESMAN_ID) REFERENCES SALESMAN(SALESMAN_ID) ON DELETE SET NULL
);

CREATE TABLE ORDERS(
ORD_NO INT PRIMARY KEY,
PURCHASE_AMT FLOAT,
ORD_DATE DATE,
CUSTOMER_ID INT REFERENCES CUSTOMER(CUSTOMER_ID) ON DELETE CASCADE,
SALESMAN_ID INT REFERENCES SALESMAN(SALESMAN_ID) ON DELETE CASCADE
);


INSERT INTO SALESMAN VALUES
(1000, 'JOHN','BANGALORE','25%'),
(2000, 'RAVI','BANGALORE','20%'),
(3000, 'KUMAR','MYSORE','15%'),
(4000, 'SMITH','DELHI','30%'),
(5000, 'HARSHA','HYDERABAD','15%');

INSERT INTO CUSTOMER VALUES 
(10, 'PREETHI', 'BANGALORE',100, 1000),
(11, 'VIVEK', 'MANGALORE', 300, 1000),
(12, 'BHASKAR', 'CHENNAI', 400, 2000),
(13, 'CHETHAN', 'BANGALORE', 200, 2000),
(14, 'MAMATHA', 'BANGALORE', 400, 3000);

INSERT INTO ORDERS VALUES
(50, 5000, '2017-05-04', 10, 1000),
(51, 450, '2017-01-20', 10, 2000),
(52, 1000, '2017-02-24', 13, 2000),
(53, 3500, '2017-04-13', 14, 3000),
(54, 550, '2017-03-09', 12, 2000);

SELECT * FROM CUSTOMER;
SELECT * FROM ORDERS;
SELECT * FROM SALESMAN;


INSERT INTO CUSTOMER VALUES (15, 'ANATH', 'BANGALORE',400, 4000);
INSERT INTO ORDERS VALUES (60, 3000, '2015-12-30', 15, 4000);

/*QUERY-1: List out the order_nos which has to be shipped to same city*/

SELECT ORD_NO FROM ORDERS O,CUSTOMER C,SALESMAN S
WHERE O.CUSTOMER_ID=C.CUSTOMER_ID AND O.SALESMAN_ID=S.SALESMAN_ID AND C.CITY=S.CITY;

/*QUERY-2: List all the orders for the salesman who belongs to the city Delhi.*/

SELECT S.NAME, O.ORD_NO FROM ORDERS O,SALESMAN S
WHERE O.SALESMAN_ID=S.SALESMAN_ID AND CITY='DELHI';


/*QUERY-3: Display all the orders which values are greater than the average order value for 30 th
December 2015*/

SELECT O.ORD_NO FROM ORDERS O 
WHERE PURCHASE_AMT > (SELECT AVG(PURCHASE_AMT) FROM ORDERS O WHERE ORD_DATE='2015-12-30');


/*QUERY-4:Display the commission of all the salesmen servicing customers in Bangalore.*/

SELECT DISTINCT COMMISSION, S.NAME FROM SALESMAN S,CUSTOMER C
WHERE C.SALESMAN_ID=S.SALESMAN_ID AND C.CITY='BANGALORE' ;

