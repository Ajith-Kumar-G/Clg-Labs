CREATE DATABASE COLLEGE;

USE COLLEGE;

CREATE TABLE STUDENT(
REGNO VARCHAR(15) PRIMARY KEY,
SNAME VARCHAR(20),
MAJOR VARCHAR(20),
BDATE DATE 
);
     
CREATE TABLE COURSE(
COURSENO INT PRIMARY KEY,
CNAME VARCHAR(20),
DEPT VARCHAR(20)
);

CREATE TABLE ENROLL(
REGNO VARCHAR(15),
COURSENO INT,
SEM INT,
MARKS INT,
PRIMARY KEY (REGNO,COURSENO),
FOREIGN KEY (REGNO) REFERENCES STUDENT(REGNO),
FOREIGN KEY (COURSENO) REFERENCES COURSE(COURSENO)
);
     
CREATE TABLE TEXT(
BOOK_ISBN INT PRIMARY KEY,
BOOK_TITLE VARCHAR(20),
PUBLISHER VARCHAR(20),
AUTHOR VARCHAR(20)
);
     
CREATE TABLE BOOK_ADOPTION(
COURSENO INT,
SEM INT,
BOOK_ISBN INT,
PRIMARY KEY (COURSENO,BOOK_ISBN),
FOREIGN KEY (COURSENO) REFERENCES COURSE(COURSENO),
FOREIGN KEY (BOOK_ISBN) REFERENCES TEXT(BOOK_ISBN)
);
     

INSERT INTO STUDENT VALUES
('1pe11cs002','b','sr','19930924'),
('1pe11cs003','c','sr','19931127'),
('1pe11cs004','d','sr','19930413'),
('1pe11cs005','e','jr','19940824'),
('1pe11cs001','a','jr','19930922');   

INSERT INTO COURSE VALUES
(111,'OS','CSE'),
(112,'EC','CSE'),
(113,'SS','ISE'),
(114,'DBMS','CSE'),
(115,'SIGNALS','ECE');

INSERT INTO TEXT VALUES 
(10,'DATABASE SYSTEMS','PEARSON','SCHIELD'),
(900,'OPERATING SYS','PEARSON','LELAND'),
(901,'CIRCUITS','HALL INDIA','BOB'),
(902,'SYSTEM SOFTWARE','PETERSON','JACOB'),
(903,'SCHEDULING','PEARSON','PATIL'),
(904,'DATABASE SYSTEMS','PEARSON','JACOB'),
(905,'DATABASE MANAGER','PEARSON','BOB'),
(906,'SIGNALS','HALL INDIA','SUMIT');


INSERT INTO ENROLL VALUES 
('1pe11cs001',115,3,100),
('1pe11cs002',114,5,100),
('1pe11cs003',113,5,100),
('1pe11cs004',111,5,100),
('1pe11cs005',112,3,100);

INSERT INTO BOOK_ADOPTION VALUES
(111,5,900),
(111,5,903),
(111,5,904),
(112,3,901),
(113,3,10),
(114,5,905),
(113,5,902),
(115,3,906);

select * from STUDENT;
select * from COURSE;
select * from ENROLL;
select * from BOOK_ADOPTION;
select * from TEXT;

/*QUERY-1*/
	
SELECT C.COURSENO,T.BOOK_ISBN,T.BOOK_TITLE FROM COURSE C,BOOK_ADOPTION BA,TEXT T
WHERE C.COURSENO=BA.COURSENO
AND BA.BOOK_ISBN=T.BOOK_ISBN
AND C.DEPT='CSE' AND 2 < (
SELECT COUNT(BOOK_ISBN)
FROM BOOK_ADOPTION B
WHERE C.COURSENO=B.COURSENO)
ORDER BY T.BOOK_TITLE;


/*QUERY-2*/

SELECT DISTINCT C.DEPT FROM COURSE C
WHERE C.DEPT IN ( SELECT C.DEPT FROM COURSE C,BOOK_ADOPTION B,TEXT T
WHERE C.COURSENO=B.COURSENO
AND T.BOOK_ISBN=B.BOOK_ISBN
AND T.PUBLISHER='HALL INDIA')
AND C.DEPT NOT IN(SELECT C.DEPT FROM COURSE C,BOOK_ADOPTION B,TEXT T
WHERE C.COURSENO=B.COURSENO
AND T.BOOK_ISBN=B.BOOK_ISBN
AND T.PUBLISHER!='HALL INDIA');