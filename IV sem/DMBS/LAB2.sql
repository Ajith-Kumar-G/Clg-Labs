CREATE DATABASE BANKING;
USE BANKING;

CREATE TABLE BRANCH(
BRANCHNAME VARCHAR(30) PRIMARY KEY,
BRANCHCITY VARCHAR(20),
ASSESTS int
);

SELECT * FROM BRANCH;

CREATE TABLE BANKACCOUNT(
ACCNO INT PRIMARY KEY,
BRANCHNAME VARCHAR(30),
BALANCE INT,
FOREIGN KEY(BRANCHNAME) REFERENCES BRANCH(BRANCHNAME)
);

SELECT * FROM BANKACCOUNT;

CREATE TABLE BANKCUSTOMER(
CUSTOMERNAME VARCHAR(30) PRIMARY KEY,
CUSTOMERSTREET VARCHAR(30),
CUSTOMERCITY VARCHAR(20)
);

SELECT * FROM BANKCUSTOMER;

CREATE TABLE LOAN(
LOANNUMBER INT PRIMARY KEY,
BRANCHNAME VARCHAR(30),
AMOUNT INT,
FOREIGN KEY(BRANCHNAME) REFERENCES BRANCH(BRANCHNAME)	
);

SELECT * FROM LOAN;

CREATE TABLE DEPOSITER(
CUSTOMERNAME VARCHAR(30),
ACCNO INT,
FOREIGN KEY(CUSTOMERNAME) REFERENCES BANKCUSTOMER(CUSTOMERNAME),
FOREIGN KEY(ACCNO) REFERENCES BANKACCOUNT(ACCNO),
PRIMARY KEY(CUSTOMERNAME,ACCNO)
);

SELECT * FROM DEPOSITER;

INSERT INTO BRANCH
VALUES ('SBI_Chamrajpet','Bangalore',50000),
('SBI_ResidencyRoad','Bangalore',10000),
('SBI_ShivajiRoad','Bombay',20000),
('SBI_ParlimentRoad','Delhi',10000),
('SBI_Jantarmantar','Delhi',20000);

INSERT INTO BANKACCOUNT
VALUES (1,'SBI_Chamrajpet',2000),
(2,'SBI_ResidencyRoad',5000),
(3,'SBI_ShivajiRoad',6000),
(4,'SBI_ParlimentRoad',9000),
(5,'SBI_Jantarmantar',8000),
(6,'SBI_ShivajiRoad',4000),
(8,'SBI_ResidencyRoad',4000),
(9,'SBI_ParlimentRoad',3000),
(10,'SBI_ResidencyRoad',5000),
(11,'SBI_Jantarmantar',2000);

INSERT INTO BANKCUSTOMER
VALUES ('Avinash','Bull_Temple_Road','Bangalore'),
('Dinesh','Bannergatta_Road','Bangalore'),
('Mohan','NationalCollege_Road','Bangalore'),
('Nikil','Akbar_Road','Delhi'),
('Ravi','Prithviraj_Road','Delhi');

INSERT INTO LOAN
VALUES (1,'SBI_Chamrajpet',1000),
(2,'SBI_ResidencyRoad',2000),
(3,'SBI_ShivajiRoad',3000),
(4,'SBI_ParlimentRoad',4000),
(5,'SBI_Jantarmantar',5000);

INSERT INTO DEPOSITER
VALUES ('Avinash',1),
('Dinesh',2),
('Nikil',4),
('Ravi',5),
('Avinash',8),
('Nikil',9),
('Dinesh',10),
('Nikil',11);

SELECT * FROM BRANCH;
SELECT * FROM BANKACCOUNT;
SELECT * FROM BANKCUSTOMER;
SELECT * FROM LOAN;
SELECT * FROM DEPOSITER;

/*QUERY-3*/

SELECT CUSTOMERNAME  FROM DEPOSITER d,BANKACCOUNT a
WHERE d.ACCNO=a.ACCNO
AND a.BRANCHNAME='SBI_ResidencyRoad'
GROUP BY d.CUSTOMERNAME
HAVING COUNT(d.CUSTOMERNAME)>=2;
            
/*QUERY-4*/

SELECT CUSTOMERNAME FROM DEPOSITER D,BANKACCOUNT BA ,BRANCH B
WHERE D.ACCNO=BA.ACCNO AND B.BRANCHNAME=BA.BRANCHNAME AND B.BRANCHCITY='DELHI'  GROUP BY(CUSTOMERNAME) 
HAVING COUNT(DISTINCT BA.BRANCHNAME)=
(SELECT COUNT(BRANCHNAME) FROM BRANCH WHERE BRANCHCITY='DELHI');


/*QUERY-5*/
DELETE FROM BANKACCOUNT WHERE BRANCHNAME IN (SELECT BRANCHNAME FROM BRANCH WHERE BRANCHCITY='BOMBAY');

SELECT * FROM BANKACCOUNT;
SELECT * FROM DEPOSITER;
