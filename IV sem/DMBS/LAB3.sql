CREATE DATABASE SUPPLIER;
USE SUPPLIER;


CREATE TABLE SUPPLIER(
SID INT PRIMARY KEY,
SNAME VARCHAR(20),
CITY VARCHAR(20)
);

CREATE TABLE PARTS(
PID INT PRIMARY KEY,
PNAME VARCHAR(20),
COLOR VARCHAR(20)
);

CREATE TABLE CATALOG(
SID INT,
PID INT,
COST REAL,
FOREIGN KEY(SID) REFERENCES SUPPLIER(SID),
FOREIGN KEY(PID) REFERENCES PARTS(PID),
PRIMARY KEY(SID, PID)
);

INSERT INTO SUPPLIER
VALUES	(10001,'Acme Widget','Bangalore'),
		(10002,'Johns','Kolkata'),
        (10003,'Vimal','Mumbai'),
        (10004,'Reliance','Delhi');

INSERT INTO PARTS
VALUES	(20001,'Book','Red'),
		(20002,'Pen','Red'),
        (20003,'Pencil','Green'),
        (20004,'Mobile','Green'),
        (20005,'Charger','Black');

INSERT INTO CATALOG 
VALUES	(10001,20001,10),
		(10001,20002,10),
        (10001,20003,30),
        (10001,20004,10),
        (10001,20005,10),
        (10002,20001,10),
        (10002,20002,20),
        (10003,20003,30),
        (10004,20003,40);

SELECT * FROM SUPPLIER;
SELECT * FROM PARTS;
SELECT * FROM CATALOG;

/*QUERY-1*/

SELECT DISTINCT PNAME FROM PARTS PA,CATALOG CT
WHERE PA.PID=CT.PID;

/*QUERY-2*/

SELECT SNAME FROM SUPPLIER S,CATALOG C
WHERE S.SID=C.SID  GROUP BY(C.SID) HAVING COUNT(C.PID)= (SELECT DISTINCT COUNT(*) FROM PARTS);

/*or*/

SELECT SNAME FROM SUPPLIER S
WHERE NOT EXISTS ( (SELECT PID FROM PARTS WHERE PID NOT IN (SELECT C.PID FROM CATALOG C WHERE C.SID = S.SID)));

 
/*QUERY-3*/

SELECT SNAME FROM SUPPLIER S
WHERE NOT EXISTS ( (SELECT PID FROM PARTS WHERE PID NOT IN (SELECT C.PID FROM CATALOG C WHERE C.SID = S.SID) AND COLOR='RED'));


/*QUERY-4*/

SELECT PNAME FROM PARTS P
WHERE PID IN ( (SELECT PID FROM PARTS WHERE PID NOT IN (SELECT C.PID FROM CATALOG C,SUPPLIER S WHERE C.SID = S.SID AND  S.SNAME <> 'Acme Widget')));

/*QUERY-5*/

SELECT DISTINCT SID FROM CATALOG C
WHERE C.COST> (SELECT AVG(C0.COST) FROM CATALOG C0 WHERE C.PID=C0.PID);

/*QUERY-6*/

SELECT P.PID, S.SNAME FROM PARTS P, SUPPLIER S, CATALOG C
WHERE S.SID=C.SID AND P.PID=C.PID AND C.COST= (SELECT MAX(C0.COST) FROM CATALOG C0 WHERE C.PID=C0.PID);